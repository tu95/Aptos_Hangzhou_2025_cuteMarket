# 🎉 cuteMarket 部署完成总结

## 📋 项目信息

**项目名称**: cuteMarket - 去中心化预测市场  
**网络**: Aptos Testnet  
**合约地址**: `0x8ebb5f208e99f14584dc352204b107f8c9570a8481cf23e830fee296bd1515cb`

---

## 🚀 访问地址

### 本地访问
```
http://localhost:5173
```

### 局域网访问
```
http://10.135.132.65:5173
```

任何在同一局域网内的设备（手机、平板、其他电脑）都可以访问！

---

## 📊 已部署的功能

### 1. 智能合约功能 ✅
- ✅ 5个内置预测项目
- ✅ 用户下注功能
- ✅ 赔率自动计算
- ✅ 奖金自动分配
- ✅ 2% 平台手续费
- ✅ 最小下注 0.01 APT

### 2. 前端功能 ✅

#### 钱包连接
- ✅ Petra 钱包支持
- ✅ 自定义钱包选择模态框
- ✅ 地址显示和断开功能

#### 首页
- ✅ 项目卡片列表
- ✅ 实时链上数据显示
- ✅ 项目图片展示
- ✅ **用户投资组合面板**
  - 总投资金额
  - 参与项目数
  - 下注次数
  - 平均每注
  - 投资分布明细

#### 项目详情页
- ✅ 项目大图展示
- ✅ 实时赔率显示
- ✅ 市场占比显示
- ✅ **用户历史下注**
  - 总下注金额
  - 下注次数
  - 下注明细
- ✅ **收益预测面板**
  - 如果赢了能获得多少
  - 净利润显示
  - 投资回报率 (ROI)
  - 实时计算

#### 投注选项卡片
- ✅ 赔率徽章
- ✅ 当前投注额
- ✅ 市场占比
- ✅ 选中时显示预期收益

---

## 🎨 视觉设计亮点

### 首页投资组合面板
```
┌─────────────────────────────────────────┐
│ 💎 你的投资组合                          │
│    0.0500 APT                           │
├─────────────────────────────────────────┤
│ [参与项目: 1] [下注次数: 1] [平均: 0.05]│
├─────────────────────────────────────────┤
│ 投资分布：                                │
│ • 川普下台 (1次) .......... 0.0500 APT  │
└─────────────────────────────────────────┘
```

### 详情页收益面板
```
┌─────────────────────────────────────────┐
│ 💰 如果你赢了，将获得         净利润     │
│    0.2450 APT              +0.1450 APT │
│ 投资回报率 (ROI): +145.0%              │
└─────────────────────────────────────────┘
```

---

## 📦 项目配置

### 5个预测项目

| ID | 名称 | 选项 | 结束时间 | 图片 |
|----|------|------|---------|------|
| 0 | 川普下台 | 下台/继续呆着 | 2026-12-25 | trump.png |
| 1 | cuteMarket赢今晚比赛 | 赢/输 | 2026-11-15 | cuteMarket.png |
| 2 | 比特币突破100万 | 突破/未突破 | 2026-12-31 | 生成金融景观图片.png |
| 3 | 诺奖得主地区 | 亚洲/欧洲/其他 | 2026-10-10 | - |
| 4 | 2026世界杯冠军 | 巴西/阿根廷/法国/其他 | 2026-07-19 | fifa2026.png |

### 合约参数
- **最小下注**: 0.01 APT (1,000,000 Octas)
- **平台手续费**: 2%
- **自动刷新**: 每 10 秒

---

## 🔗 重要链接

### 合约浏览器
https://explorer.aptoslabs.com/account/0x8ebb5f208e99f14584dc352204b107f8c9570a8481cf23e830fee296bd1515cb?network=testnet

### 部署交易
- **合约部署**: https://explorer.aptoslabs.com/txn/0x6dbad061bca6456ab09da30f91a622eb8d055186ba9212f22d660fd191e91e88?network=testnet
- **市场初始化**: https://explorer.aptoslabs.com/txn/0x3b9f6b9f46a038e20f56c961b5cf81f7d46e7b33e7e799aecd6c649bb0320973?network=testnet
- **测试下注**: https://explorer.aptoslabs.com/txn/0x95b68b1c1c7153505f10e3d09d0395cad6b651ed77203edc1554a63d32d6be4d?network=testnet

---

## 🧪 测试数据

### 初始下注记录
- **项目**: 项目0 (川普下台)
- **金额**: 0.05 APT
- **选项**: 0 (下台)
- **地址**: `0x8ebb5f208e99f14584dc352204b107f8c9570a8481cf23e830fee296bd1515cb`

---

## 📁 关键文件

### 智能合约
```
move/
├── Move.toml                    # 合约配置
└── sources/
    └── cutemarket.move          # 主合约代码
```

### 前端代码
```
src/
├── components/
│   ├── Header.tsx              # 头部导航
│   ├── ProjectCard.tsx         # 项目卡片（带图片和数据）
│   └── WalletButton.tsx        # 钱包连接按钮
├── pages/
│   ├── Home.tsx               # 首页（带投资组合）
│   └── ProjectDetail.tsx      # 详情页（带历史和收益）
├── hooks/
│   ├── useProjectData.ts      # 项目数据 Hook
│   ├── useUserBets.ts         # 单项目下注 Hook
│   └── useAllUserBets.ts      # 所有项目下注 Hook
├── utils/
│   └── oddsCalculator.ts      # 赔率计算工具
├── config/
│   └── aptos.ts              # Aptos 配置
└── data/
    └── projects.ts            # 项目数据
```

---

## 🎯 核心功能实现

### 赔率计算公式
```typescript
// 扣除 2% 手续费后的奖池
prizePool = totalPool × (1 - 0.02)

// 赔率 = 奖池 / 该选项投注额
odds = prizePool / optionPool

// 预期收益 = (用户投注 / 获胜池) × 奖池
expectedReturn = (userBet / winningPool) × prizePool

// 投资回报率
ROI = ((expectedReturn - userBet) / userBet) × 100
```

### 数据流
```
用户连接钱包
    ↓
自动加载历史下注 (useAllUserBets)
    ↓
首页显示投资组合
    ↓
进入项目详情
    ↓
加载项目数据 (useProjectData)
加载用户下注 (useUserBets)
    ↓
实时计算赔率和收益
    ↓
用户下注
    ↓
自动刷新所有数据
```

---

## 🚀 启动命令

### 开发模式
```bash
npm run dev
```

### 编译合约
```bash
cd move
aptos move compile --named-addresses cutemarket=0x8ebb5f208e99f14584dc352204b107f8c9570a8481cf23e830fee296bd1515cb
```

### 部署合约
```bash
aptos move publish --named-addresses cutemarket=0x8ebb5f208e99f14584dc352204b107f8c9570a8481cf23e830fee296bd1515cb --profile cutemarket_v3 --assume-yes
```

### 查询项目信息
```bash
aptos move view \
  --function-id 0x8ebb5f208e99f14584dc352204b107f8c9570a8481cf23e830fee296bd1515cb::prediction_market::get_project_info \
  --args u64:0
```

---

## 📝 使用指南

### 用户操作流程

1. **访问网站**
   - 本地: http://localhost:5173
   - 局域网: http://10.135.132.65:5173

2. **连接钱包**
   - 点击右上角 "Connect Wallet"
   - 选择 Petra 钱包
   - 授权连接

3. **查看投资组合**（如果有历史下注）
   - 首页顶部显示紫粉渐变卡片
   - 显示总投资、参与项目、下注次数
   - 展开显示各项目的投资分布

4. **选择项目**
   - 浏览项目卡片
   - 查看实时投注额和赔率
   - 点击进入详情页

5. **下注**
   - 选择投注选项
   - 输入金额（≥ 0.01 APT）
   - 查看预期收益
   - 点击下注按钮
   - 钱包确认交易

6. **查看历史**
   - 详情页显示你在该项目的下注
   - 显示总金额、次数、明细

---

## 🎉 完成的优化

### 最新更新（按时间倒序）

✅ **2025-11-15 20:00** - 首页投资组合面板
- 显示总投资金额
- 显示参与项目数和下注次数
- 显示平均每注
- 展开显示各项目投资分布

✅ **2025-11-15 19:45** - 用户历史下注
- 详情页显示用户在当前项目的下注
- 显示总金额和次数
- 展开显示每笔下注明细

✅ **2025-11-15 19:30** - 收益展示优化
- 大绿卡显示"如果赢了能获得多少"
- 显示净利润和 ROI
- 选项卡片显示预期收益

✅ **2025-11-15 19:00** - 项目图片功能
- 首页卡片顶部显示图片
- 详情页大图展示
- 悬停放大动画

✅ **2025-11-15 18:30** - 局域网访问
- 配置 Vite 监听 0.0.0.0
- 支持手机等设备访问

✅ **2025-11-15 18:00** - 钱包连接优化
- 自定义钱包选择模态框
- 更好的用户体验

✅ **2025-11-15 17:00** - 时间戳修复
- 所有项目改为 2026 年
- 重新部署合约
- 测试下注成功

---

## 🎯 未来可能的改进

- [ ] 添加开奖历史页面
- [ ] 显示每个项目的 ROI 排名
- [ ] 添加通知系统（项目开奖提醒）
- [ ] 移动端优化
- [ ] 多钱包支持（Martian, Pontem 等）
- [ ] 主网部署

---

## 📞 技术支持

如需帮助，请查看：
- `QUICKSTART.md` - 快速开始指南
- `FEATURES.md` - 功能说明文档
- `USER_GUIDE.md` - 用户使用指南
- `README.md` - 项目说明

---

**祝你使用愉快！预测准确，大赚特赚！** 🎉💰🚀

